function findLargestPlayingVideo(){const e=Array.from(document.querySelectorAll("video")).filter((e=>0!=e.readyState)).filter((e=>0==e.disablePictureInPicture)).sort(((e,t)=>{const i=e.getClientRects()[0]||{width:0,height:0},r=t.getClientRects()[0]||{width:0,height:0};return r.width*r.height-i.width*i.height}));if(0!==e.length)return e[0]}async function requestPictureInPicture(e){await e.requestPictureInPicture(),e.setAttribute("__pip__",!0),e.addEventListener("leavepictureinpicture",(t=>{e.removeAttribute("__pip__")}),{once:!0}),new ResizeObserver(maybeUpdatePictureInPictureVideo).observe(e)}function maybeUpdatePictureInPictureVideo(e,t){const i=e[0].target;if(!document.querySelector("[__pip__]"))return void t.unobserve(i);const r=findLargestPlayingVideo();r&&!r.hasAttribute("__pip__")&&(t.unobserve(i),requestPictureInPicture(r))}(async()=>{const e=findLargestPlayingVideo();e&&(e.hasAttribute("__pip__")?document.exitPictureInPicture():(await requestPictureInPicture(e),chrome.runtime.sendMessage({message:"enter"})))})();