import { w as we } from './reactivity.esm-bundler-3cf16f7a.js';
import { t } from './storage-e4d9282e.js';

const o={stickyElements:[],fixedElements:[],absoluteElements:[],overflowHiddle:[],scrollElement:null,fixedBottomChangedList:[],stickyBottomChangedList:[],data:null,stopCapture:!1,pauseCapture:!1,originalBodyOverflowYStyle:"",originalOverflowStyle:"",arrangements:[],captureIdx:0,contentHeight:0,windowWidth:0,app:null,openPageHome:we(!1),scrollElementInfo:null},n=new Set,i=t=>{let e=`${r(t)}_screencapture`;return e=e.replaceAll(".","_"),e+"-"+Date.now()+".png"},r=t=>{const e=t.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return e&&e[1]},a=t=>{const e=new Image;e.src=t,e.style.maxWidth="100vw";const o=window.open("");o&&(o.document.body.style.margin="0",o.document.write(e.outerHTML));},s=t=>{let e=null;const o=document.body.getElementsByTagName("*"),n=[],i=[],r=[],a=[],s=[],l=[];let c=0,d=!1;const u=document.documentElement,m=document.body;for(let h=0;h<o.length;h++){const p=o[h],g=getComputedStyle(p),w=g.getPropertyValue("position"),y="hidden"===g.getPropertyValue("visibility"),f="none"===g.getPropertyValue("display"),b=g.getPropertyValue("overflow"),P=g.getPropertyValue("overflow-y"),E=g.getPropertyValue("box-shadow"),v=y||f;let C=!1;if(C=window.location.href.includes("www.youtube.com")?"scroll"===b||"auto"===b||"overlay"===b||"visible"===b||"scroll"===P||"auto"===P||"overlay"===P||"hidden"===P||"visible"===P:"scroll"===b||"auto"===b||"overlay"===b||"scroll"===P||"auto"===P||"overlay"===P,"none"!=E&&l.push(p),C&&(t=!0),C&&!v&&t){let t=Number(g.getPropertyValue("height").replace("px","")),o=Number(g.getPropertyValue("width").replace("px",""));if(t>400&&o>400&&0<p.scrollHeight)if(window.location.href.includes(".gemoo.com")&&window.location.href.includes("detail")){if(p.scrollHeight>t){e=p,c=e.scrollHeight;break}}else (window.location.href.includes("docs.qq.com")||window.location.href.includes("chat.openai.com"))&&p.scrollHeight>t&&(d||(e=p,c=e.scrollHeight,d=!0)),d||(e=p,c=e.scrollHeight);}if("fixed"===w&&!v){const t=getComputedStyle(p),e=parseInt(t.width),o=parseInt(t.height);!!(parseInt(t.getPropertyValue("bottom"))<=0&&(e>=u.clientWidth||e>=m.clientWidth)&&o<window.innerHeight/2)?a.push(p):r.push(p);}if("sticky"===w&&!v){const t=getComputedStyle(p),e=parseInt(t.width);parseInt(t.getPropertyValue("bottom"))<=0&&(e>=document.documentElement.clientWidth||e>=document.body.clientWidth)&&i.push(p),n.push(p);}"absolute"!==w||v||s.push(p);}if(e){e.getBoundingClientRect().top+e.scrollHeight<=window.innerHeight&&(e=null);}return e&&window.document.body.scrollHeight>e.scrollHeight&&(e=null),window.location.href.includes("https://www.youtube.com/")&&(e=null),window.location.href.includes("chat.openai.com"),{stickyElements:n,fixedElements:r,absoluteElements:s,scrollHight:c,shadowElements:l,isChatLeft:!1,scrollElement:t&&e?e:void 0,fixedBottomElements:a,stickyBottomElements:i}},l=(t,e)=>{for(const o of t)e?o.style.setProperty("position",e,"important"):o.style.setProperty("position",e);},c=(t=[])=>{const e=document.body,n=document.documentElement,i=[n.clientHeight,e?e.scrollHeight:0,n.scrollHeight,e?e.offsetHeight:0,n.offsetHeight,...t];return o.scrollElement?window.innerHeight:Math.max(...i)},d=()=>{"hidden"===document.body.style.overflow||o.scrollElement||(document.body.style.overflow="hidden");},u=()=>{"hidden"===document.body.style.overflow&&(document.body.style.overflow="unset");},m=(t,e)=>{t.forEach((t=>{t.style.opacity&&t.style.setProperty("opacity",e);}));},h=(t,e=void 0)=>{if(!n.has(t)&&!o.scrollElement){n.add(t);const o=document.createElement("style");t&&(o.id=t);const i="\n\t\t\t::-webkit-scrollbar {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\thtml {\n\t\t\t\tscrollbar-width: none !important;\n\t\t\t\t-ms-overflow-style: none !important;\n\t\t\t}\n\t\t\tbody {\n\t\t\t\tscrollbar-width: none !important;\n\t\t\t\t-ms-overflow-style: none !important;\n\t\t\t}\n\t\t";o.appendChild(document.createTextNode(i)),e?e(o):document.body.appendChild(o);}},p=()=>{n.forEach((t=>{const e=`#${t}`,o=document.querySelector(e);o&&document.body.removeChild(o);})),n.clear();},g=()=>{o.fixedBottomChangedList.forEach((t=>{t?.elm.style.setProperty("display",t.initStyle);})),o.stickyBottomChangedList.forEach((t=>{t?.elm.style.setProperty("display",t.initStyle);})),o.fixedBottomChangedList.length>0&&(o.fixedBottomChangedList=[]),o.stickyBottomChangedList.length>0&&(o.stickyBottomChangedList=[]);},w=t=>{const e=window.getComputedStyle(t);e.transition&&(t.style.transition="unset"),e.animation&&(t.style.animation="unset"),e.opacity&&"1"!==e.opacity||(t.style.opacity="0");},y=()=>{var t="Win32"==navigator.platform||"Windows"==navigator.platform,e="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;return e?"Mac":"X11"!=navigator.platform||t||e?String(navigator.platform).indexOf("Linux")>-1?"Linux":t?"windows":"other":"Unix"},f="https://api.gemoo.com/v1",b="application/json;charset=UTF-8";let P;async function E(t$1,o){P=new AbortController;const n=await t("access_token"),i={method:"GET",headers:{"Content-type":b,Authorization:n?"Bearer "+n:"",UserProduct:"plug"},credentials:"same-origin",mode:"cors"};o=Object.assign(i,o);const{method:r,body:a}=o;if("GET"===r){if(a){const e=[];Object.keys(a).forEach((t=>e.push(t+"="+encodeURIComponent(a[t])))),-1===t$1.search(/\?/)?t$1+="?"+e.join("&"):t$1+="&"+e.join("&");}delete o.body;}return Promise.race([new Promise(((t,e)=>{setTimeout((()=>{e(new Error("request timeout"));}),6e3);})),new Promise(((e,n)=>{fetch(f+t$1,o).then((async t=>{if(!/^(2|3)\d{2}$/.test(t.status))return t.status,Promise.reject(t);t.text().then((async t=>{let o=t.replace(/"\w+":\s*\d{16,}/g,(function(t){let e=t.split(":");return e[0]+':"'+e[1].trim()+'"'}));o=await JSON.parse(o),e(o);}));})).catch((t=>{n(t);}));}))])}const v=(t,e)=>E(t,{body:e}),C=(t,e,o)=>E(t,{method:"POST",body:JSON.stringify(e),...o});function k(t){return C("/auth/login",t)}function x(){return v("/user/getUserProfile")}function U(t){return C("/auth/google/generateRedirectUrl",t)}function H(){return v("/user/getUserSpaceSize")}function S(t,e){return C("/cloud/amazon/createMultipartUpload",t,e)}function L(t,e){return C("/cloud/amazon/createMultipartUploadPartURL",t,{timeout:0,...e})}function M(t,e){return C("/cloud/amazon/completeMultipartUploadPart",t,e)}function z(t){return C("/cloud/amazon/abortMultipartUploadPart",t)}function I(t,e){return C("/page/createEmptyPage",{...t},e)}function B(t,e){return C("/image/createEmptyImage",{source:4,...t},e)}function j(t){return v("/page/getBindCard",t)}function _(t){return C("/auth/apple/generateRedirectUrl",t)}const R="https://app.gemoo.com";function T(t,e=460,o=290,n){const i=new Image;return i.src=t,new Promise(((r,a)=>{n?V(t,e,o,r):(i.onload=()=>{V(i,e,o,r);},i.onerror=()=>{a("urlerror");});}))}function V(t,e,o,n){const i=document.createElement("canvas");if(t.height>=t.width){if(t.width<e){i.width=e,i.height=o;return i.getContext("2d").drawImage(t,(i.width-t.width)/2,(i.height-t.height)/2,t.width,t.height),n(i.toDataURL("image/jpeg"))}i.width=e,i.height=e/t.width*t.height;i.getContext("2d").drawImage(t,0,0,i.width,i.height),n(i.toDataURL("image/jpeg"));}else {if(t.height<o){i.width=e,i.height=o;return i.getContext("2d").drawImage(t,(i.width-t.width)/2,(i.height-t.height)/2,t.width,t.height),n(i.toDataURL("image/jpeg"))}i.height=o,i.width=o/t.height*t.width;i.getContext("2d").drawImage(t,0,0,i.width,i.height),n(i.toDataURL("image/jpeg"));}}let O=null;class N{put(t,e){if(t instanceof File)return new Promise(((o,n)=>{(function(t,e){return C("/cloud/amazon/getS3PutObjectPresignedURL",t,e)})({file_name:t.name},e).then((({code:e,result:i})=>{if(0===e){let{key:e,name:r,presigned_url:a}=i;(function(t,e){O=new AbortController;const{signal:o}=O;return fetch(t,{method:"put",body:e,signal:o})})(a,t).then((t=>{200===t.status?o({key:e,name:r,res:t}):n(t);})).catch(n);}else n();})).catch(n);}))}multipartUpload(t){}}const W=async(t={})=>{let{card:e,name:o,base64:n,thumbnail:i,signal:r,partitionSize:a=10485760,uploadStart:s=(()=>null),uploadEnd:l=(()=>null),uploadError:c=(()=>null),uploadProgress:d=(()=>null)}=t;if(!n||!o)throw new Error("required parameter missing");e||(e=void 0),s(),d("getSpaceSize");const u=function(t,e,o){const n=t.split(","),i=atob(n[1]);let r=i.length;const a=new Uint8Array(r);for(;r--;)a[r]=i.charCodeAt(r);return new File([a],e,{type:o})}(n,o+".png","image/png");await new Promise(((t,e)=>{H().then((o=>{const{code:n,result:i}=o;if(0===n){const n=i.surplus;u.size>n&&(e(o),c("size",o));const r={0:()=>{o.result.limit.imageLimitNumber-o.result.limit.imageUsedNumber<=0?(e(o),c("number",o)):t(o);},1:()=>{t(o);},2:()=>{t(o);}};if(!r[i.limit.version])throw new Error("The user type is not added");r[i.limit.version]();}else 402===n?(e(o),c("login",o)):(e(o),c(o));})).catch((()=>{e(),c("network");}));})),d("createEmptyPage");const m={card_id:e,type:2,name:o},h=await function(t){return new Promise(((e,o)=>{I(t).then((t=>{const{code:n,result:i}=t;if(0===n){const{id:t}=i;e(t);}else o(t),c("createEmpty",t);})).catch((()=>{o(),c("network");}));}))}(m);d("createEmptyPageEnd",{page:h}),d("createMultipart");const p=await new Promise(((t,e)=>{S({file_info:{name:u.name,type:u.type||"unknow",size:u.size}},{signal:r}).then((o=>{const{code:n,result:i}=o;0===n?t(i):(e(o),c("createMultipart",o));})).catch((()=>{e(),c("network");}));}));d("createMultipartEnd",(function(){const{id:t,key:e}=p;z({upload_info:{id:t,key:e}});})),d("createMultipartUrl"),await function(t){const e=[];if(u.size>a){let t=0,o=0;for(;;){o+=a;const n=u.slice(t,o);if(t+=a,!n.size)break;e.push(n);}}else e.push(u.slice(0));const{id:o,key:n}=t,i=e.map(((t,e)=>new Promise(((i,a)=>{L({upload_info:{id:o,key:n,number:e+1,length:t.size}},{signal:r}).then((e=>{const{code:o,result:n}=e;if(0===o){const{presigned_url:e}=n;fetch(e,{method:"put",body:t,headers:{"Content-Type":"application/json"},signal:r}).then(i).catch(a);}else a();})).catch(a);}))));return new Promise(((t,e)=>{Promise.all(i).then(t).catch((()=>{e(),c("uploadMultipart");}));}))}(p),d("mergeMultipart"),await function(t){const{id:e,key:o}=t;return new Promise(((t,n)=>{M({upload_info:{id:e,key:o}},{signal:r}).then((e=>{const{code:o,result:i}=e;0===o?t(i):(n(e),c("mergeMultipart",e));})).catch((()=>{n(),c("network");}));}))}(p);let g="";i||(g=""),d("createImage");const w={page_id:h,card_id:e,description:"",data:p.key,thumbnail:g,name:o},y=await function(t){return new Promise(((e,o)=>{B(t).then((t=>{const{code:n,result:i}=t;0===n?e(t):(o(t),c("create",t));})).catch((()=>{o(),c("network");}));}))}(w);l(y);};function A(t){window.onbeforeunload=t?()=>!1:null;}

export { A, B, H, I, L, M, N, P, R, S, T, U, W, _, a, c, d, f, g, h, i, j, k, l, m, o, p, s, u, w, x, y, z };
